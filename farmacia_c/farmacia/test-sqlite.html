<!DOCTYPE html>
<html>
<head>
    <title>Teste SQLite3 WASM - Farm√°cia Igor</title>
</head>
<body>
    <h1>Teste SQLite3 WASM</h1>
    <div id="output" style="font-family: monospace; white-space: pre;"></div>

    <script src="jswasm/sqlite3.js"></script>
    <script>
        const output = document.getElementById('output');
        
        function log(msg) {
            console.log(msg);
            output.textContent += msg + '\n';
        }

        log('=== TESTE SQLITE3 WASM ===');
        log('Fun√ß√µes encontradas:');
        log('- sqlite3InitModule: ' + (window.sqlite3InitModule ? 'SIM' : 'N√ÉO'));
        log('- sqlite3InitModuleState: ' + (window.sqlite3InitModuleState ? 'SIM' : 'N√ÉO'));

        // Inicializa o m√≥dulo WASM
        if (window.sqlite3InitModule) {
            log('\n--- Inicializando m√≥dulo WASM ---');
            
            window.sqlite3InitModule().then((sqlite3) => {
                log('‚úÖ M√≥dulo SQLite3 inicializado com sucesso!');
                log('Fun√ß√µes dispon√≠veis: ' + Object.keys(sqlite3).join(', '));
                
                // Agora testa o uso
                log('\n--- Teste de banco de dados ---');
                try {
                    const db = new sqlite3.oo1.DB("/test.db");
                    log('‚úÖ Banco criado');
                    
                    db.exec("CREATE TABLE IF NOT EXISTS produtos (id INTEGER, nome TEXT)");
                    log('‚úÖ Tabela criada');
                    
                    db.exec("INSERT INTO produtos VALUES (1, 'Dipirona')");
                    log('‚úÖ Dados inseridos');
                    
                    const resultados = db.exec("SELECT * FROM produtos");
                    log('‚úÖ Consulta executada: ' + JSON.stringify(resultados));
                    
                    db.close();
                    log('\nüéâ SQLITE3 WASM FUNCIONANDO!');
                    
                } catch(e) {
                    log('‚ùå Erro no banco: ' + e.toString());
                }
                
            }).catch((error) => {
                log('‚ùå Erro na inicializa√ß√£o: ' + error.toString());
            });
            
        } else {
            log('‚ùå sqlite3InitModule n√£o encontrado');
        }
    </script>
</body>
</html>